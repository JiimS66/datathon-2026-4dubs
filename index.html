<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Air for All Good - 2025 US Air Quality Dashboard</title>
    <style>
        /* --- 0. 设计系统 (Design System) --- */
        :root {
            /* 核心色盘 */
            --primary-color: #2E5C55;      
            --accent-color: #4DB6AC;       
            --bg-body: #F4F7F6;            
            --bg-card: #FFFFFF;            
            --text-main: #2C3E50;          
            --text-secondary: #546E7A;     
            --text-light: #78909C;

            /* 间距与圆角 */
            --border-radius: 16px;
            
            /* 阴影 */
            --card-shadow: 0 4px 20px rgba(0, 0, 0, 0.04);
            --header-shadow: 0 2px 10px rgba(0, 0, 0, 0.03);
        }

        /* --- 1. 全局样式重置 --- */
        * { box-sizing: border-box; }
        
        html {
            scroll-behavior: smooth;
            scroll-padding-top: 100px;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: var(--bg-body);
            color: var(--text-main);
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
        }

        /* --- 2. 顶部导航 --- */
        .site-header {
            background-color: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid rgba(0,0,0,0.05);
            box-shadow: var(--header-shadow);
        }

        .header-content {
            max-width: 1400px; 
            margin: 0 auto;
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .site-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
            margin: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .site-title::before {
            content: "";
            display: block;
            width: 12px;
            height: 12px;
            background-color: var(--accent-color);
            border-radius: 50%;
        }

        .header-logo-container img {
            height: 40px;
            width: auto;
            display: block;
        }

        /* --- 3. Hero 区域 --- */
        .hero-section {
            max-width: 800px;
            margin: 60px auto 40px auto;
            padding: 0 20px;
            text-align: center;
        }

        .hero-section h1 {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--text-main);
            margin-bottom: 20px;
            letter-spacing: -0.5px;
        }
        
        .hero-section p {
            font-size: 1.1rem;
            color: var(--text-secondary);
            margin-bottom: 30px;
            max-width: 650px;
            margin-left: auto;
            margin-right: auto;
        }

        /* --- 4. 核心布局 --- */
        .layout-wrapper {
            max-width: 1400px;
            margin: 0 auto 80px auto;
            padding: 0 30px;
            display: flex;
            gap: 40px;
            position: relative;
        }

        /* --- 左侧边栏 --- */
        .sidebar-nav {
            width: 260px;
            flex-shrink: 0;
            position: sticky;
            top: 100px;
            height: fit-content;
            max-height: calc(100vh - 120px);
            overflow-y: auto;
            padding-right: 10px;
        }

        .nav-link {
            display: block;
            padding: 12px 15px;
            margin-bottom: 8px;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: 8px;
            font-size: 0.95rem;
            font-weight: 500;
            transition: all 0.2s ease;
            border-left: 3px solid transparent; 
        }

        .nav-link:hover {
            background-color: rgba(77, 182, 172, 0.08); 
            color: var(--primary-color);
        }

        .nav-link.active {
            background-color: rgba(77, 182, 172, 0.15);
            color: var(--primary-color);
            border-left-color: var(--accent-color);
            font-weight: 600;
        }

        /* --- 右侧内容区域 --- */
        .dashboard-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 40px;
            min-width: 0; 
        }

        .content-group {
            display: grid;
            gap: 40px;
            scroll-margin-top: 100px;
        }

        /* --- 卡片通用样式 --- */
        .data-card {
            background: var(--bg-card);
            border-radius: var(--border-radius);
            box-shadow: var(--card-shadow);
            padding: 30px;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            border: 1px solid rgba(0,0,0,0.02);
            overflow: hidden;
        }

        .data-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.06);
        }

        .card-header {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--primary-color);
            margin: 0;
        }

        /* --- 文本内容增强样式 (Typography) --- */
        .card-text-block {
            color: var(--text-secondary);
            font-size: 1rem;
            line-height: 1.7;
            margin-bottom: 20px;
            text-align: justify;
        }

        /* 图表上方的描述文字 */
        .chart-description {
            font-size: 0.95rem;
            color: var(--text-secondary);
            background-color: #F4F8F7; /* 极淡的绿色背景 */
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid var(--accent-color);
        }

        /* 方法论板块 */
        .method-box {
            background-color: rgba(46, 92, 85, 0.05); /* 主色调的最淡变体 */
            padding: 20px;
            border-radius: 12px;
            margin-top: 25px;
        }
        
        .method-box h4 {
            margin-top: 0;
            color: var(--primary-color);
            font-size: 1.1rem;
        }

        .method-box p {
            margin-bottom: 0;
            font-size: 0.95rem;
            color: var(--text-secondary);
        }

        /* --- 数据表格样式 (Data Table) --- */
        .table-responsive {
            overflow-x: auto;
            margin: 20px 0;
        }

        .ej-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.95rem;
            border: 1px solid #eee;
        }

        .ej-table thead {
            background-color: rgba(77, 182, 172, 0.1);
        }

        .ej-table th {
            text-align: left;
            padding: 15px;
            color: var(--primary-color);
            font-weight: 600;
        }

        .ej-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
            color: var(--text-secondary);
        }

        .ej-table tbody tr:hover {
            background-color: #fafafa;
        }

        /* 结论引用块 */
        .conclusion-block {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }

        .conclusion-block h4 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .source-citation {
            margin-top: 20px;
            font-size: 0.8rem;
            color: var(--text-light);
            font-style: italic;
            word-break: break-all;
        }

        /* --- 数据集介绍卡片专用 --- */
        .card-body-split { display: flex; align-items: flex-start; gap: 40px; }
        .split-text { flex: 1; min-width: 300px; }
        .split-image { flex: 1; display: flex; justify-content: center; align-items: center; }
        .split-image img { width: 100%; max-width: 500px; height: auto; border-radius: 12px; box-shadow: 0 4px 15px rgba(77, 182, 172, 0.15); object-fit: cover; }
        .dataset-list { margin: 0; padding-left: 20px; color: var(--text-secondary); font-size: 0.95rem; }
        .dataset-list li { margin-bottom: 10px; }
        .dataset-list li::marker { color: var(--accent-color); }
        .tableauPlaceholder { width: 100%; border-radius: 8px; overflow: hidden; }

        footer { text-align: center; padding: 40px 0; color: var(--text-secondary); font-size: 0.9rem; border-top: 1px solid rgba(0,0,0,0.05); background: #fff; }

        @media (max-width: 1024px) { 
            .layout-wrapper { flexDirection: column; }
            .sidebar-nav { display: none; }
            .header-content { padding: 15px 20px; }
            .card-body-split { flexDirection: column-reverse; gap: 20px; }
        }
    </style>
</head>
<body>

    <header class="site-header">
        <div class="header-content">
            <div class="site-title">Air for All Good</div>
            <div class="header-logo-container">
                <img src="Datathon.png" alt="Datathon Logos">
            </div>
        </div>
    </header>

    <section class="hero-section">
        <h1>Unveiling the Invisible: <br>US Air Quality 2025</h1>
        <p>
            An in-depth analysis of respiratory health and environmental future. 
            We use data to reveal the true picture of PM2.5 and Ozone levels across the nation.
        </p>
    </section>

    <div class="layout-wrapper">
        
        <aside class="sidebar-nav">
            <nav id="navbar">
                <a href="#group-dataset" class="nav-link">Dataset Overview</a>
                <a href="#group-overview" class="nav-link">Overview & Trends</a>
                <a href="#group-analysis" class="nav-link">Deep Dive Analysis</a>
                <a href="#group-impact" class="nav-link">Health & Impacts</a>
            </nav>
        </aside>

        <main class="dashboard-content">
            
            <section id="group-dataset" class="content-group">
                <article class="data-card">
                    <div class="card-header">
                        <h3 class="card-title">Dataset Overview</h3>
                    </div>
                    <div class="card-body-split">
                        <div class="split-text">
                            <ul class="dataset-list">
                                <li><strong>Scope:</strong> 978 county-level records for 2025.</li>
                                <li><strong>Coverage:</strong> Across 54 state-level entities.</li>
                                <li><strong>Granularity:</strong> 763 unique county names.</li>
                                <li><strong>Type:</strong> Single-year cross-sectional dataset.</li>
                                <li><strong>Metrics:</strong> Median AQI, Max AQI, Pollutant indicators.</li>
                                <li><strong>Note:</strong> Partial monitoring network coverage.</li>
                            </ul>
                        </div>
                        <div class="split-image">
                            <img src="AQI Dataset.png" alt="AQI Data Flow Map">
                        </div>
                    </div>
                </article>
            </section>

            <section id="group-overview" class="content-group">
                <article class="data-card">
                    <div class="card-header">
                        <h3 class="card-title">Geographical Overview & Status</h3>
                    </div>
                    <div class='tableauPlaceholder' id='viz1770512051199' style='position: relative'>
                        <noscript><a href='#'><img alt='US Air Quality Map ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;ma&#47;map1_17705120367170&#47;USAirQualityMap&#47;1_rss.png' style='border: none' /></a></noscript>
                        <object class='tableauViz' style='display:none;'>
                            <param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> 
                            <param name='embed_code_version' value='3' /> 
                            <param name='site_root' value='' />
                            <param name='name' value='map1_17705120367170&#47;USAirQualityMap' />
                            <param name='tabs' value='no' />
                            <param name='toolbar' value='yes' />
                            <param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;ma&#47;map1_17705120367170&#47;USAirQualityMap&#47;1.png' /> 
                            <param name='animate_transition' value='yes' />
                            <param name='display_static_image' value='yes' />
                            <param name='display_spinner' value='yes' />
                            <param name='display_overlay' value='yes' />
                            <param name='display_count' value='yes' />
                            <param name='language' value='en-US' />
                        </object>
                    </div>
                </article>
                
                <article class="data-card">
                    <div class="card-header">
                        <h3 class="card-title">Advanced Trends & Insights</h3>
                    </div>
                    <div class='tableauPlaceholder' id='viz1770504480900' style='position: relative'>
                        <noscript><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;JD&#47;JD2BCT4QF&#47;1_rss.png' style='border: none' /></a></noscript>
                        <object class='tableauViz' style='display:none;'>
                            <param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='path' value='shared&#47;JD2BCT4QF' /> <param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;JD&#47;JD2BCT4QF&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /><param name='language' value='zh-CN' />
                        </object>
                    </div>
                </article>
            </section>

            <section id="group-analysis" class="content-group">
                <article class="data-card">
                    <div class="card-header">
                        <h3 class="card-title">Pollutant Analysis & Risk Assessment</h3>
                    </div>
                    <div class='tableauPlaceholder' id='viz1770504438446' style='position: relative'>
                        <noscript><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;5Z&#47;5ZBGB5Z3Y&#47;1_rss.png' style='border: none' /></a></noscript>
                        <object class='tableauViz' style='display:none;'>
                            <param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='path' value='shared&#47;5ZBGB5Z3Y' /> <param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;5Z&#47;5ZBGB5Z3Y&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /><param name='language' value='en-US' />
                        </object>
                    </div>
                </article>

                <article class="data-card">
                    <div class="card-header">
                        <h3 class="card-title">Comprehensive Data Visualization</h3>
                    </div>
                    <div class='tableauPlaceholder' id='viz1770504457892' style='position: relative'>
                        <noscript><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;W7&#47;W77CGS4QW&#47;1_rss.png' style='border: none' /></a></noscript>
                        <object class='tableauViz' style='display:none;'>
                            <param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='path' value='shared&#47;W77CGS4QW' /> <param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;W7&#47;W77CGS4QW&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /><param name='language' value='zh-CN' />
                        </object>
                    </div>
                </article>
            </section>

            <section id="group-impact" class="content-group">
                
                <article class="data-card">
                    <div class="card-header">
                        <h3 class="card-title">Environmental Justice & Health Disparities Analysis</h3>
                    </div>
                    <div class="card-text-block">
                        <p>
                            This part investigates environmental justice in U.S. air quality by integrating county-level AQI data with the EPA Environmental Justice (EJ) Index. We construct an Unhealthy Risk Index using pollutant-specific unhealthy day counts, with emphasis on PM2.5 and Ozone, and quantify community vulnerability using EJ percentiles. Counties are compared using a quantile-based framework, focusing on the top and bottom 20% of pollution and EJ risk to isolate structural disparities.
                        </p>
                        <p>
                            This analysis reveals that high-pollution counties are disproportionately concentrated in high EJ vulnerability groups, indicating non-random exposure patterns. Furthermore, counties facing both high pollution and high EJ risk exhibit significantly elevated asthma prevalence, suggesting compounding health impacts. Pollutant decomposition shows that PM2.5 and Ozone days are the dominant contributors to pollution burden in high-risk counties. Spatial clustering further highlights regional patterns of persistent inequality.
                        </p>
                        <p>
                            Overall, the findings demonstrate that air pollution risk in the U.S. is systematically aligned with social and environmental vulnerability, underscoring the need for targeted, data-driven environmental justice interventions.
                        </p>
                    </div>
                    
                    <div class="method-box">
                        <h4>Methodology</h4>
                        <p>
                            This study applies feature aggregation, percentile-based stratification, and comparative subgroup analysis to uncover structural relationships between environmental exposure and social vulnerability. Rather than predictive modeling, the focus is on interpretable risk segmentation and pollutant attribution to support policy-relevant insights.
                        </p>
                    </div>
                </article>

                <article class="data-card">
                    <div class="card-header">
                        <h3 class="card-title">Asthma Prevalence & Vulnerability</h3>
                    </div>
                    <div class="chart-description">
                        Average county-level asthma prevalence by Environmental Justice (EJ) group under different pollution risk levels, showing amplified health impacts in high EJ counties under high pollution conditions.
                    </div>
                    <div class='tableauPlaceholder' id='viz1770511153978' style='position: relative'>
                        <noscript><a href='#'><img alt='Asthma Prevalence Increases with Environmental Justice Vulnerability, Especially Under High Pollution ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Ta&#47;TableauTab_17705075189980&#47;AsthmaPrevalenceIncreaseswithEnvironmentalJusticeVulnerabilityEspeciallyUnderHighPollution&#47;1_rss.png' style='border: none' /></a></noscript>
                        <object class='tableauViz'  style='display:none;'>
                            <param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='site_root' value='' /><param name='name' value='TableauTab_17705075189980&#47;AsthmaPrevalenceIncreaseswithEnvironmentalJusticeVulnerabilityEspeciallyUnderHighPollution' /><param name='tabs' value='no' /><param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Ta&#47;TableauTab_17705075189980&#47;AsthmaPrevalenceIncreaseswithEnvironmentalJusticeVulnerabilityEspeciallyUnderHighPollution&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /><param name='language' value='zh-CN' />
                        </object>
                    </div>
                </article>

                <article class="data-card">
                    <div class="card-header">
                        <h3 class="card-title">EJ Composition in High Pollution Areas</h3>
                    </div>
                    <div class="chart-description">
                        Composition of Environmental Justice risk groups within high- and medium-pollution counties, demonstrating the disproportionate concentration of high EJ vulnerability in high pollution areas and the dominance of PM2.5 and Ozone exposure.
                    </div>
                    <div class='tableauPlaceholder' id='viz1770511203453' style='position: relative'>
                        <noscript><a href='#'><img alt='Fig2_EJ_Composition_by_Pollution ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Hi&#47;HighEnvironmentalJusticeCountiesAreDisproportionatelyRepresentedAmongHigh-PollutionCounties&#47;Fig2_EJ_Composition_by_Pollution&#47;1_rss.png' style='border: none' /></a></noscript>
                        <object class='tableauViz'  style='display:none;'>
                            <param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='site_root' value='' /><param name='name' value='HighEnvironmentalJusticeCountiesAreDisproportionatelyRepresentedAmongHigh-PollutionCounties&#47;Fig2_EJ_Composition_by_Pollution' /><param name='tabs' value='no' /><param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Hi&#47;HighEnvironmentalJusticeCountiesAreDisproportionatelyRepresentedAmongHigh-PollutionCounties&#47;Fig2_EJ_Composition_by_Pollution&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /><param name='language' value='zh-CN' />
                        </object>
                    </div>
                </article>

                <article class="data-card">
                    <div class="card-header">
                        <h3 class="card-title">Geographic Distribution of Inequities</h3>
                    </div>
                    <div class="chart-description">
                        Geographic distribution of high-risk counties reveals regional clustering of combined pollution and environmental justice burden, indicating systematic and place-based exposure inequities.
                    </div>
                    <div class='tableauPlaceholder' id='viz1770511312112' style='position: relative'>
                        <noscript><a href='#'><img alt='Fig3_Driver_PM25 ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Fi&#47;Fig3_Driver_PM25&#47;Fig3_Driver_PM25&#47;1_rss.png' style='border: none' /></a></noscript>
                        <object class='tableauViz'  style='display:none;'>
                            <param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='site_root' value='' /><param name='name' value='Fig3_Driver_PM25&#47;Fig3_Driver_PM25' /><param name='tabs' value='no' /><param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Fi&#47;Fig3_Driver_PM25&#47;Fig3_Driver_PM25&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /><param name='language' value='zh-CN' />
                        </object>
                    </div>
                </article>

                <article class="data-card">
                    <div class="card-header">
                        <h3 class="card-title">Data Evidence & Final Conclusion</h3>
                    </div>
                    
                    <p><strong>Datasets Summary: Average Asthma Prevalence by Group</strong></p>
                    <div class="table-responsive">
                        <table class="ej-table">
                            <thead>
                                <tr>
                                    <th>Pollution Group</th>
                                    <th>EJ Vulnerability Group</th>
                                    <th>Asthma Prevalence (%)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td rowspan="3" style="font-weight: 500;">High Pollution (Top 20%)</td>
                                    <td>Low EJ (Bottom 20%)</td>
                                    <td>10.24%</td>
                                </tr>
                                <tr>
                                    <td>Middle 60%</td>
                                    <td>10.88%</td>
                                </tr>
                                <tr style="background-color: #fff3f3;"> <td style="color: #d32f2f;">High EJ (Top 20%)</td>
                                    <td style="color: #d32f2f; font-weight:bold;">12.42%</td>
                                </tr>
                                
                                <tr>
                                    <td rowspan="3" style="font-weight: 500;">Middle 60% Pollution</td>
                                    <td>Low EJ (Bottom 20%)</td>
                                    <td>10.41%</td>
                                </tr>
                                <tr>
                                    <td>Middle 60%</td>
                                    <td>11.00%</td>
                                </tr>
                                <tr>
                                    <td>High EJ (Top 20%)</td>
                                    <td>11.74%</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="conclusion-block">
                        <h4>Conclusion</h4>
                        <p class="card-text-block">
                            Countries with higher environmental justice vulnerability experience disproportionately higher asthma prevalence, even at similar levels of air pollution, and this disparity is further amplified under high pollution conditions. These patterns indicate that pollution-related health risks are shaped not only by exposure levels, but also by underlying social and environmental vulnerabilities.
                        </p>
                    </div>

                    <div class="source-citation">
                        <strong>EJI Data Source:</strong> Centers for Disease Control and Prevention and Agency for Toxic Substances Disease Registry. [2024] Environmental Justice Index. Accessed [02/07/2025]. https://atsdr.cdc.gov/place-health/php/eji/eji-data-download.html
                    </div>
                </article>

            </section>

        </main>
    </div>

    <script type='text/javascript'>
        function initTableauViz(divId) {
            var divElement = document.getElementById(divId);
            if(divElement) {
                var vizElement = divElement.getElementsByTagName('object')[0];
                vizElement.style.width = '100%';
                vizElement.style.height = (divElement.offsetWidth * 0.75) + 'px';
                vizElement.style.minHeight = '500px'; 
            }
        }

        var vizIds = [
            'viz1770512051199', 
            'viz1770504480900', 
            'viz1770504438446', 
            'viz1770504457892', 
            'viz1770511153978', 
            'viz1770511203453', 
            'viz1770511312112'  
        ];
        
        vizIds.forEach(initTableauViz);

        var scriptElement = document.createElement('script');
        scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';
        document.body.appendChild(scriptElement);

        // 滚动监听
        document.addEventListener('DOMContentLoaded', () => {
            const sections = document.querySelectorAll('.content-group');
            const navLinks = document.querySelectorAll('.nav-link');

            const observerOptions = {
                root: null,
                rootMargin: '-30% 0px -60% 0px', 
                threshold: 0
            };

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        navLinks.forEach(link => link.classList.remove('active'));
                        const id = entry.target.getAttribute('id');
                        const activeLink = document.querySelector(`.nav-link[href="#${id}"]`);
                        if (activeLink) {
                            activeLink.classList.add('active');
                        }
                    }
                });
            }, observerOptions);

            sections.forEach(section => {
                observer.observe(section);
            });
        });
    </script>

    <footer>
        &copy; 2026 Air for All Good Project. <br>
        <span style="opacity: 0.6; font-size: 0.8em;">Data visualization powered by Tableau & Public Data Sources.</span>
    </footer>

</body>
</html>
